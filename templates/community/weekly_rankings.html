{% extends 'base.html' %}
{% load static %}

{% block title %}Weekly Rankings - Swipe&Bite{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-md-12">
            <h1 class="display-4 fw-bold text-tinder mb-3">
                üèÜ Weekly Rankings
            </h1>
            <p class="lead text-muted">The top dishes of the week based on community votes</p>
        </div>
    </div>

    <!-- Current Week Rankings -->
    {% if current_week_rankings %}
    <div class="row mb-5">
        <div class="col-md-12">
            <h3 class="fw-bold mb-3">This Week's Top 10</h3>
            <div class="card">
                <div class="card-body">
                    {% for ranking in current_week_rankings %}
                        <div class="ranking-item {% if forloop.first %}first-place{% elif forloop.counter == 2 %}second-place{% elif forloop.counter == 3 %}third-place{% endif %}">
                            <div class="d-flex align-items-center p-3 mb-2 rounded">
                                <div class="rank-number me-4">
                                    {% if forloop.first %}
                                        <h1 class="mb-0">ü•á</h1>
                                    {% elif forloop.counter == 2 %}
                                        <h1 class="mb-0">ü•à</h1>
                                    {% elif forloop.counter == 3 %}
                                        <h1 class="mb-0">ü•â</h1>
                                    {% else %}
                                        <h2 class="fw-bold text-tinder mb-0">#{{ ranking.rank }}</h2>
                                    {% endif %}
                                </div>
                                <img src="{{ ranking.dish.display_image }}" alt="{{ ranking.dish.name }}" class="rounded me-3" style="width: 80px; height: 80px; object-fit: cover;">
                                <div class="flex-grow-1">
                                    <h5 class="mb-1 fw-bold">{{ ranking.dish.name }}</h5>
                                    <p class="mb-1 text-muted small">{{ ranking.dish.cuisine.name }}</p>
                                    <div>
                                        <span class="badge bg-secondary">{{ ranking.total_swipes }} swipes</span>
                                        <span class="badge bg-success">{{ ranking.match_rate }}% match rate</span>
                                        <span class="badge bg-warning">‚≠ê {{ ranking.average_rating|floatformat:1 }}</span>
                                    </div>
                                </div>
                                <div>
                                    <a href="{% url 'dishes:dish_detail' ranking.dish.id %}" class="btn btn-primary">
                                        View Dish
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Previous Weeks -->
    {% if previous_weeks %}
    <div class="row">
        <div class="col-md-12">
            <h3 class="fw-bold mb-3">Previous Weeks</h3>
            <div class="list-group">
                {% for week in previous_weeks %}
                    <a href="#" class="list-group-item list-group-item-action">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-0">{{ week.week_start|date:"M d" }} - {{ week.week_end|date:"M d, Y" }}</h6>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
</div>

<style>
    .ranking-item {
        transition: all 0.3s;
    }

    .ranking-item:hover {
        background-color: rgba(254, 60, 114, 0.05);
    }

    .first-place {
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%);
    }

    .second-place {
        background: linear-gradient(135deg, rgba(192, 192, 192, 0.1) 0%, rgba(192, 192, 192, 0.05) 100%);
    }

    .third-place {
        background: linear-gradient(135deg, rgba(205, 127, 50, 0.1) 0%, rgba(205, 127, 50, 0.05) 100%);
    }

    .rank-number {
        min-width: 80px;
        text-align: center;
    }
</style>
{% endblock %}